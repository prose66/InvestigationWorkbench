# Unified Event Schema

This project uses a single, unified event shape to normalize Splunk and Kusto query exports. Files are NDJSON or CSV with one row per event.

## Required Fields

| Column | Type | Notes |
| --- | --- | --- |
| event_ts | string (ISO 8601 UTC) | Example: `2024-07-01T12:34:56Z` |
| source | string | `splunk` or `kusto` |
| event_type | string | Normalized type, e.g. `process_start` |
| host | string | Hostname |
| user | string | Username or principal |
| src_ip | string | Source IP address |
| dest_ip | string | Destination IP address |
| process_name | string | Process name (if applicable) |
| process_cmdline | string | Full command line |
| file_hash | string | File hash (SHA256 preferred) |
| outcome | string | `success`, `failure`, or `unknown` |
| severity | string | `low`, `medium`, `high`, `critical` |
| message | string | Human-readable summary |

## Provenance Fields

These fields are stored at the query run level, but may also appear per row:

| Column | Type | Notes |
| --- | --- | --- |
| run_id | string | UUID generated by the workbench |
| query_name | string | Friendly label |
| executed_at | string (ISO 8601 UTC) | Query execution time |
| time_start | string (ISO 8601 UTC) | Query window start |
| time_end | string (ISO 8601 UTC) | Query window end |
| source_event_id | string | Upstream ID if available |
| raw_json | string (JSON) | Optional raw payload |

## Optional Extensions

Additional fields are allowed. Unknown columns are stored in `raw_json` when ingested.
